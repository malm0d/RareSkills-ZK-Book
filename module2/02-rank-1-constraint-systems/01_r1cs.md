# Converting Algebraic Circuits to R1CS
https://www.rareskills.io/post/rank-1-constraint-system

## Prerequisites
- Arithmetic circuits
- Modular arithmetic
- All operations here happen in a finite field, so $-5$ is the additive inverse of $5 \ (\text{mod}\ p)$; and $2/3$ is the multiplicative inverse of $3 \ (\text{mod}\ p)$ times $2$.

## R1CS Overview
A Rank 1 Constraint System (R1CS) is an arithmetic circuit with the requirement that each equality constraint has one multiplication (and no restriction on the number of additions). 

That is, each constraint in an R1CS (each line in the system of equations) enforces exactly ONE multiplication between two linear combinations of variables (e.g. $x \cdot x$, or $x \cdot y$, etc), with no restrictions on the number of additions within those linear combinations or across the system of equations.

This makes the representation of the arithmetic circuit compatible with the use of bilinear pairings. The output of a bilinear pairing: $e: G_1 \bullet G_2 \rightarrow G_T$ cannot be paired again, as an element in $G_T$ cannot be used as part of the input of another bilinear pairing ($G_T$ is a multiplicative subgroup of a finte field, while $G_1$ and $G_2$ are elliptic curve groups). As such, we only allow one multiplication per constraint.

## The Witness Vector
In an arithmetic circuit, the witness is an assignment of values to all signals (variables) such that all constraints (equations) in the circuit are satisfied.

In an R1CS, the witness is a $1 \times n$ vector that contains the values of all input variables, output variables, and intermediate variables. It demonstrates that we have executed the circuit from start to finish, knowing all the input, output, and intermediate values.

By convention, the first element is always: $1$, 

This helps to make some calculations easier (more later).

For example, if we have the constraint:

$$
z = x^{2}y
$$

and we claim to know the solution for the constraint, then it means that we know: $x$, $y$, and $z$.

Because R1CS require exactly one multiplication per constraint, the above polynomial constraint above must broken down into simpler constraints, each with only ONE multiplication:

$$
v_1 = xx \\
z = v_1y
$$

A witness means that we don't just know $x$, $y$, and $z$, it also means we must also know every intermediate variable in the system of equations. Thus, our witness is the vector:

$$
[1, z, x, y, v_1]
$$

where each term has a value that satisfies the constraints above.

For example:

$$
[1, 18, 3, 2, 9]
$$

is a valid witness because when we pass the values into the circuit

$$
[constant = 1, \ z = 18, \ x = 3, \ y = 2, \ v_1 = 9]
$$

it satisfies the constraints

$$
\begin{align*}
v_1 = x \ast x \quad &\rightarrow \quad 9 = 3 \ast 3 \\
z = v_1 \ast y \quad &\rightarrow \quad 18 = 9 \ast 2
\end{align*}
$$

Note that the $1$ term in the witness vector is not used in this example, and it is a convenience that will be explained later on.

## Exmaple 1: Transforming $z = xy$ into a R1CS
